## 환경

| 종류 | 기술스택       | 버전                        |
| ---- | -------------- | --------------------------- |
| JVM  | Java           | 11.0.20                     |
| WAS  | Spring Boot    | 2.7.15                      |
| IDE  | IntelliJ       | 2023.1.3 (Ultimate Edition) |
|      | Docker Desktop | 4.22.0                      |
|      | Node.js        | 18.16.1                     |
|      | vs code        | 1.81.1                      |

## 백엔드(Tally) 실행하기

1. `git clone https://lab.ssafy.com/s09-fintech-finance-sub2/S09P22A108.git` 프로젝트 내의 `backend` 디렉토리에 접속
2. backend 디렉토리 내에 `/tallydocker/docker-compose.yml` 생성
3. backend 디렉토리 root에 `.env` 생성
4. `docker-compose.yml` 내의 서비스 실행
5. 어플리케이션 실행
6. `http://localhost:8080` 에서 어플리케이션이 실행되었는지 확인

## 환경 변수 및 프로퍼티 파일

`docker-compose.yml`

```java
version: '3'
services:
  mariadb:
    image: mariadb:11.0.2
    ports:
      - "3307:3306"
    environment:
      MARIADB_DATABASE: tally
      MARIADB_USER: sss
      MARIADB_PASSWORD: tallysssA108
      MARIADB_ROOT_PASSWORD: test
    volumes:
      - "./mariadb/conf.d:/etc/mysql/conf.d"
      - "./mariadb/data:/var/lib/mysql"
    container_name: mariadb-tally

  redis:
    image: redis:latest
    ports:
      - "6380:6379"
    environment:
      - REDIS_PASSWORD=banksssA108
    container_name: redis-tally

  mongodb:
    image: mongo
    ports:
      - "27017:27017"
    volumes:
      - "./mongodb/data:/data/db"
    container_name: mongodb-tally
```

`.env`

```java
DB_HOST=localhost
DB_PORT=3307
DB_NAME=tally
DB_USER=sss
DB_PASSWORD=tallysssA108

REDIS_HOST=localhost
REDIS_PORT=6380
REDIS_PASSWORD=tallysssA108

FCM_KEY_PATH=firebase/tally-ec2a7-firebase-adminsdk-5iget-2e7be4b4a6.json
FCM_KEY_SCOPE=https://www.googleapis.com/auth/cloud-platform

MONGO_USER=sss
MONGO_PASSWORD=tallysssA108
MONGO_HOST=localhost
MONGO_PORT=27017
MONGO_DB=tally

TOKEN_SECRET=${지정할 token 비밀번호}

COUNTRY_SERVICE_KEY=lQexMZMXDyFSmMCHE%2BbQj%2Fcm7uDGA%2Fn0AuNXPx0rfTPz%2BDOj%2FRX8U1Ay50ntvW2CJgOgOpMvoBYNohwsp%2BQMsw%3D%3D

AWS_ACCESS_KEY=AKIASUML2QGYW3YCZ5M5
AWS_SECRET_KEY=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

NAVER_CLIENT_ID=72_pzxA28ZArtTUiswrv
NAVER_CLIENT_SECRET=OJwNOv3kXJ
```

## 백엔드(SSS-bank) 실행하기

1. `git clone https://lab.ssafy.com/s09-fintech-finance-sub2/S09P22A108.git` 프로젝트 내의 `SSS-bank-Backend` 디렉토리에 접속
2. backend 디렉토리 내에 `/sssdocker/docker-compose.yml` 생성
3. backend 디렉토리 root에 `.env` 생성
4. `docker-compose.yml` 내의 서비스 실행
5. 어플리케이션 실행
6. `http://localhost:8080` 에서 어플리케이션이 실행되었는지 확인

## 환경 변수 및 프로퍼티 파일

`docker-compose.yml`

```java
version: '3'
services:
  mariadb:
    image: mariadb:11.0.2
    ports:
      - "3306:3306"
    environment:
      MARIADB_DATABASE: bank
      MARIADB_USER: sss
      MARIADB_PASSWORD: banksssA108
      MARIADB_ROOT_PASSWORD: test
    volumes:
      - "./mariadb/conf.d:/etc/mysql/conf.d"
      - "./mariadb/data:/var/lib/mysql"
    container_name: mariadb-bank

  redis:
    image: redis:latest
    ports:
      - "6379:6379"
    environment:
      - REDIS_PASSWORD=banksssA108
    container_name: redis-bank
```

`.env`

```java
DB_HOST=localhost
DB_PORT=3306
DB_NAME=bank
DB_USER=sss
DB_PASSWORD=banksssA108

KAKAO_CLIENT_ID=${발급받은 kakao client id}
KAKAO_CLIENT_SECRET=${발급받은 kakao Javascript Key}

TOKEN_SECRET=${지정할 token secret key}

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=banksssA108

COUNTRY_SERVICE_KEY=lQexMZMXDyFSmMCHE%2BbQj%2Fcm7uDGA%2Fn0AuNXPx0rfTPz%2BDOj%2FRX8U1Ay50ntvW2CJgOgOpMvoBYNohwsp%2BQMsw%3D%3D
```

## 프론트엔드(Tally) 실행하기

1. `git clone https://lab.ssafy.com/s09-fintech-finance-sub2/S09P22A108.git` 후 프로젝트 경로 내의 `frontend` 디렉토리에 접속
2. `frontend` 디렉토리 경로 내에서 `npm install` 실행
3. `frontend` 디렉토리 경로 root에 `.env` 생성
4. `npm run start` 명령어로 어플리케이션 실행
5. `a`를 입력하여 android 애뮬레이터 실행
6. 애뮬레이터에 어플리케이션이 실행되었는지 확인

## 환경 변수 및 프로퍼티 파일

`.env`

```java
KAKAO_APP_KEY=kakao${카카오 소셜 로그인을 위해 발급받은 네이티브 키}
APP_KEY=${카카오 소셜 로그인을 위해 발급받은 네이티브 키}
BACK_ADDR="${tally 백엔드 주소}/"
WEATHER_API_KEY=${Accu Weather API에서 발급받은 API key}
EX_KEY=${한국 수출입 은행에서 발급 받은 API 키}
FIREBASE_API_KEY=${firebase에 등록한 앱의 API 키}
OCR_KEY=${OCR 라이브러리 API 키}
```

## 프론트엔드(SSS-bank) 실행하기

1. `git clone https://lab.ssafy.com/s09-fintech-finance-sub2/S09P22A108.git`클론 후 프로젝트 경로 내의 `SSS-bank-Frontend` 디렉토리에 접속
2. `SSS-bank-Frontend` 디렉토리 경로 내에서 `npm install` 실행
3. `SSS-bank-Frontend` 디렉토리 root에 `.env` 생성
4. `npm run start` 명령어로 어플리케이션 실행
5. `http://localhost:3000` 에서 어플리케이션이 실행되었는지 확인

## 환경 변수 및 프로퍼티 파일

`.env`

```java
REACT_APP_KAKAO_CLIENT_ID=${발급받은 kakao client id}
REACT_APP_KAKAO_REDIRECT_URI=${프론트엔드 주소}/oauth/kakao/callback
REACT_APP_BACK_ADDR="${백엔드 주소}/"
```

# 💫 배포 방법

## 프론트엔드(SSS-bank) 배포 설정

### 1. Dockerfile 작성

`/var/lib/jenkins/workspace/{아이템 이름}/SSS-bank-Frontend/Dockerfile`

```java
FROM node:18.16.1

WORKDIR /app

COPY package.json .
RUN npm install
COPY . .

EXPOSE 3000

CMD ["npm", "run", "build"]
```

### 2. .env 작성

`/var/lib/jenkins/workspace/{아이템 이름}/SSS-bank-Frontend/.env`

```java
REACT_APP_KAKAO_CLIENT_ID=${카카오 소셜 로그인 클라이언트 아이디}
REACT_APP_KAKAO_REDIRECT_URI=${프론트엔드 주소}/oauth/kakao/callback
REACT_APP_BACK_ADDR="${백엔드 주소}/"
```

### 1. Jenkins 환경 설정

1. Jenkins - 관리 - Tools - Node.js 18.16.1 버전 설치
2. Jenkins - Plugins - Gitlab Plugin 설치

### 2. 자동 빌드 설정하기

1. 프로젝트 아이템 생성 (빈 프로젝트)
2. 소스 코드 관리 - Git 선택
3. Repository URL에 Gitlab URL 입력 후 Credentials 인증 진행
4. Branches to build - Branch Specifier (blank for 'any') - `/develop` 으로 지정 (빌드 할 브랜치로 지정)
5. 빌드 유발 - Build when a change is pushed to GitLab 선택
6. Enabled GitLab triggers의 Push Events/Opened Merge Request Events/Approved Merge Requests (EE-only)/Comments 선택
7. 고급 - Filter branches by name `develop`(빌드 할 브랜치) 입력
8. Secret Token 생성 후 저장
9. Gitlab Repository 접속 후 Setting - Webhooks - URL과 Secret Token, 브랜치 명 입력 후 저장
10. 빌드환경 - Provide Node & npm bin/ folder to PATH 선택 후 설치한 NodeJS 선택
11. Build Steps - Execute Shell에 명령어 입력

```java
docker rm react-bank
docker rmi react-bank
cd SSS-bank-Frontend
docker build -t react-bank .
docker run --name react-bank -d -p 3000:3000 -v /var/lib/jenkins/workspace/react-bank/SSS-bank-Frontend/build:/app/build react-bank
```

## 프론트엔드(Tally) 배포 설정

<aside>
💡 안드로이드 버전용 입니다.

</aside>

### 1. 안드로이드용 서명키를 발급합니다

```jsx
keytool -genkey -v -keystore [key-name].keystore -alias [key alias] -keyalg RSA -keysize 2048 -validity 10000
```

### 2. 발급한 키를 프로젝트명/android/app 폴더에 넣습니다.

### 3. 키 설정을 진행합니다

android/gradle.properties 파일 아래 코드 추가

```jsx
MYAPP_RELEASE_STORE_FILE=[key-name]
MYAPP_RELEASE_KEY_ALIAS=[key alias]
MYAPP_RELEASE_STORE_PASSWORD=*****
MYAPP_RELEASE_KEY_PASSWORD=*****
```

android/app/build.gradle 파일 아래에 코드 추가

```jsx
...
android {
    ...
    defaultConfig { ... }
    signingConfigs {
        release {
            if (project.hasProperty('MYAPP_RELEASE_STORE_FILE')) {
                storeFile file(MYAPP_RELEASE_STORE_FILE)
                storePassword MYAPP_RELEASE_STORE_PASSWORD
                keyAlias MYAPP_RELEASE_KEY_ALIAS
                keyPassword MYAPP_RELEASE_KEY_PASSWORD
            }
        }
    }
    buildTypes {
        release {
            ...
            signingConfig signingConfigs.release
        }
    }
}
...
```

### 4. 아래 명령어를 통해 빌드 합니다.

```jsx
./gradlew assembleRelease
```

5. android/app/build/outputs/apk/release 경로에서 apk 파일 확인 가능합니다.

## 백엔드 배포(SSS-bank) 설정

### 1. Dockerfile 작성

`/var/lib/jenkins/workspace/{아이템 이름}/SSS-bank-Backend/Dockerfile`

```java
FROM openjdk:11

ADD ./build/libs/bank-0.0.1-SNAPSHOT.jar app.jar

ENTRYPOINT ["java", "-jar", "-Dspring.profiles.active=${설정할 profile 정보}", "-Duser.timezone=Asia/Seoul", "./app.jar"]
```

### 1. Jenkins 환경 설정

1. Jenkins - 관리 - Tools - Gradle 설치 (gradle-sss-bank)
2. Jenkins - Plugins - Gitlab Plugin 설치

### 2. 자동 빌드 설정하기

1. 프로젝트 아이템 생성 (빈 프로젝트)
2. 소스 코드 관리 - Git 선택
3. Repository URL에 Gitlab URL 입력 후 Credentials 인증 진행
4. Branches to build - Branch Specifier (blank for 'any') - `/develop` 로 지정 (빌드 할 브랜치로 지정)
5. 빌드 유발 - Build when a change is pushed to GitLab 선택
6. Enabled GitLab triggers의 Push Events/Opened Merge Request Events/Approved Merge Requests (EE-only)/Comments 선택
7. 고급 - Filter branches by name `develop`(빌드 할 브랜치) 입력
8. Secret Token 생성 후 저장
9. Gitlab Repository 접속 후 Setting - Webhooks - URL과 Secret Token, 브랜치 명 입력 후 저장
10. Build Steps - Execute Shell에 명령어 입력

```java
docker stop spring-bank
docker rm spring-bank
docker rmi spring-bank
cd SSS-bank-Backend
/var/lib/jenkins/tools/hudson.plugins.gradle.GradleInstallation/gradle-sss-bank/bin/gradle clean bootJar
docker build /var/lib/jenkins/workspace/spring-bank/SSS-bank-Backend/. -t spring-bank
docker run --network bank -p 8011:8011 --name spring-bank -d spring-bank
```

### 3. yml 설정

아래 내용을 추가하기

```java
server:
    port: 8081
```

## 백엔드 배포(Tally) 설정

### 1. Dockerfile 작성

`/var/lib/jenkins/workspace/{아이템 이름}/backend/Dockerfile`

```java
FROM openjdk:11

ADD ./build/libs/tally-0.0.1-SNAPSHOT.jar app.jar

ENTRYPOINT ["java", "-jar", "-Dspring.profiles.active=${설정할 profile 정보}", "-Duser.timezone=Asia/Seoul", "./app.jar"]
```

### 1. Jenkins 환경 설정

1. Jenkins - 관리 - Tools - Gradle 설치 (gradle-tally)
2. Jenkins - Plugins - Gitlab Plugin 설치

### 2. 자동 빌드 설정하기

1. bank 자동 빌드 설정과 동일함
2. Build Steps - Execute Shell에 명령어 입력

```java
docker stop spring-tally
docker rm spring-tally
docker rmi spring-tally
cd backend
/var/lib/jenkins/tools/hudson.plugins.gradle.GradleInstallation/gradle-tally/bin/gradle clean bootJar
docker build /var/lib/jenkins/workspace/spring-tally/backend/. -t spring-tally
docker run --network tally -p 8010:8010 --name spring-tally -d spring-tally
```

## nginx 설정

### 1. nginx 설치

```java
sudo apt update
sudo apt install nginx
```

### 2. 설정 파일 생성

```java
cd /etc/nginx/sites-available
vim default
```

default 파일에 아래 내용을 작성한다

```java
server {
        server_name j9a108.p.ssafy.io;

        location / {
                root /var/lib/jenkins/workspace/${아이템이름}/SSS-bank-Frontend/build;
                index index.html index.htm;
                try_files $uri $uri/ /index.html;
        }

        location /wasApi {
                rewrite ^/wasApi(.*)$ $1 break;
                proxy_pass http://j9a108.p.ssafy.io:8011;
                proxy_http_version 1.1;
                proxy_set_header Connection "";
                proxy_set_header Host $host;
                proxy_set_header X-Real-IP $remote_addr;
        }

        location /api {
                rewrite ^/api(.*)$ $1 break;
                proxy_pass http://j9a108.p.ssafy.io:8010;
                proxy_http_version 1.1;
                proxy_set_header Connection "";
                proxy_set_header Host $host;
                proxy_set_header X-Real-IP $remote_addr;
        }
}
```

### 4. SSL 인증서 발급

certbot을 설치한다

```java
sudo apt-get update
sudo apt-get upgrade
sudo add-get-repository ppa:certbot/certbot
sudo apt-get update
sudo apt-get install python-certbot-nginx
sudo certbot --nginx -d ${도메인 주소} -d ${도메인 주소}
```

nginx를 재시작 한다

```java
sudo nginx -t
sudo systemctl restart nginx
```

`/etc/nginx/sites-available/default` 파일에 certbot이 추가한 443 정보가 있다면 성공!

```java
listen [::]:443 ssl ipv6only=on; # managed by Certbot
listen 443 ssl; # managed by Certbot
ssl_certificate /etc/letsencrypt/live/j9a108.p.ssafy.io/fullchain.pem; # managed by Certbot
ssl_certificate_key /etc/letsencrypt/live/j9a108.p.ssafy.io/privkey.pem; # managed by Certbot
include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

server {
    if ($host = j9a108.p.ssafy.io) {
        return 301 https://$host$request_uri;
    } # managed by Certbot

        listen 80 default_server;
        listen [::]:80 default_server;
        server_name j9a108.p.ssafy.io;
    return 404; # managed by Certbot

}
```

# ⚠️실행, 배포 시 주의할 점

1. SSS-bank가 배포된 후, tally를 배포하여야 합니다.
2. SSS-bank의 url 주소가 변했다면 backend 폴더 내 Feign client의 주소가 `https://j9a108.p.ssafy.io/wasApi` 로 지정된 모든 곳을 해당 주소로 수정해야 합니다. (실행 하였을 때에도 동일합니다.)
3. 지역 정보를 저장하기 위한 api를 요청해야 합니다.
4. (sss-bank) `GET {bank back 주소}/country` 나라 정보 반환 시, 성공
5. (tally) `POST {tally back 주소}/destination/state` OK 응답 시, 성공
6. (tally) `POST {tally back 주소}/destination/city` OK 응답 시, 성공
7. (tally) `GET {tally back 주소}/destination/state` OK 응답 시, 성공
8. (tally) `GET {tally back 주소}/country` 나라 정보 반환 시, 성공
9. 아래의 쿼리문을 로컬 또는 서버 mariadb에 실행해야 합니다.
10. sss-bank에 필요한 쿼리문

    ```sql
    use bank;

    insert into bank (bank_name,bank_code) values
       ("경남은행", '039'),
       ("광주은행", '034'),
       ("단위농협", '012'),
       ("부산은행", '032'),
       ("새마을금고", '045'),
       ("신한은행", '088'),
       ("씨티은행", '027'),
       ("우리은행", '020'),
       ("전북은행", '037'),
       ("제주은행", '035'),
       ("카카오뱅크", '090'),
       ("케이뱅크", '089'),
       ("토스뱅크", '092'),
       ("하나은행", '081'),
       ("기업은행", '003'),
       ("국민은행", '004'),
       ("대구은행", '031'),
       ("산업은행", '002'),
       ("농협은행", '011'),
       ("SC제일은행", '023'),
       ("수협은행", '007');
    ```

11. tally에 필요한 쿼리문

    ```sql
    use tally;

    insert into bank (bank_name,bank_code) values
       ("경남은행", '039'),
       ("광주은행", '034'),
       ("단위농협", '012'),
       ("부산은행", '032'),
       ("새마을금고", '045'),
       ("신한은행", '088'),
       ("씨티은행", '027'),
       ("우리은행", '020'),
       ("전북은행", '037'),
       ("제주은행", '035'),
       ("카카오뱅크", '090'),
       ("케이뱅크", '089'),
       ("토스뱅크", '092'),
       ("하나은행", '081'),
       ("기업은행", '003'),
       ("국민은행", '004'),
       ("대구은행", '031'),
       ("산업은행", '002'),
       ("농협은행", '011'),
       ("SC제일은행", '023'),
       ("수협은행", '007');

    -- 시 쿼리문
    update state set english_name='Seoul'
    where state_id=1;
    update state set english_name='Busan'
    where state_id=2;
    update state set english_name='Daegu'
    where state_id=3;
    update state set english_name='Incheon'
    where state_id=4;
    update state set english_name='Gwangju'
    where state_id=5;
    update state set english_name='Daejeon'
    where state_id=6;
    update state set english_name='Ulsan'
    where state_id=7;
    update state set english_name='Jeju'
    where state_id=15;

    -- 도시 쿼리
    delete from city where city_name="보령시";
    delete from city where city_name="순천시";

    update city set english_name='Suwon'
    where city_name="수원시";
    update city set english_name='Seongnam'
    where city_name="성남시";
    update city set english_name='Uijeongbu'
    where city_name="의정부시";
    update city set english_name='Chungju'
    where city_name="청주시";
    update city set english_name='Cheongju'
    where city_name="충주시";
    update city set english_name='Jecheon'
    where city_name="제천시";
    update city set english_name='Cheonan'
    where city_name="천안시";
    update city set english_name='Gongju'
    where city_name="공주시";
    update city set english_name='Jeonju'
    where city_name="전주시";
    update city set english_name='Gunsan'
    where city_name="군산시";
    update city set english_name='Iksan'
    where city_name="익산시";
    update city set english_name='Mokpo'
    where city_name="목포시";
    update city set english_name='Yeosu'
    where city_name="여수시";
    update city set english_name='Pohang'
    where city_name="포항시";
    update city set english_name='Gyeongju'
    where city_name="경주시";
    update city set english_name='Gimcheon'
    where city_name="김천시";
    update city set english_name='Changwon'
    where city_name="창원시";
    update city set english_name='Jinju'
    where city_name="진주시";
    update city set english_name='Tongyeong'
    where city_name="통영시";
    update city set english_name='Chuncheon'
    where city_name="춘천시";
    update city set english_name='Wonju'
    where city_name="원주시";
    update city set english_name='Gangneung'
    where city_name="강릉시";

    -- 카테고리 쿼리문
    insert into category values (1, "숙소"),
                                (2, "항공"),
                                (3, "교통"),
                                (4, "관광"),
                                (5, "식사"),
                                (6, "쇼핑"),
                                (7, "기타");

    -- payment unit 쿼리문
    insert into payment_unit values
                                 (1, "미국", "USD(미국 달러)"),
                                 (2, "중국", "CNY(위안)"),
                                 (3, "일본", "JPY(엔)"),
                                 (4, "유럽", "EUR(유로)"),
                                 (5, "스위스", "CHF(프랑)"),
                                 (6, "영국", "GBP(파운드스털링)"),
                                 (7, "베트남", "VND(둥)"),
                                 (8, "대한민국", "KRW(원)");

    -- 회화 정보 가져오기 위한 쿼리문

    UPDATE tally.country
    SET language = 'fr'
    WHERE country_name IN ('프랑스', '벨기에', '룩셈부르크');

    UPDATE tally.country
    SET language = 'it'
    WHERE country_name IN ('이탈리아', '산마리노');

    UPDATE tally.country
    SET language = 'ru'
    WHERE country_name IN ('러시아', '벨라루스', '카자흐스탄');

    UPDATE tally.country
    SET language = 'de'
    WHERE country_name IN ('독일', '오스트리아', '스위스', '리히텐슈타인', '룩셈부르크');

    UPDATE tally.country
    SET language = 'th'
    WHERE country_name IN ('태국', '캄보디아', '미얀마');

    UPDATE tally.country
    SET language = 'id'
    WHERE country_name IN ('인도네시아', '동티모르', '말레이시아', '네덜란드');

    UPDATE tally.country
    SET language = 'vi'
    WHERE country_name IN ('베트남');

    UPDATE tally.country
    SET language = 'zh-TW'
    WHERE country_name IN ('대만', '홍콩', '마카오');

    UPDATE tally.country
    SET language = 'zh-CN'
    WHERE country_name IN ('중국', '싱가포르');

    UPDATE tally.country
    SET language = 'ja'
    WHERE country_name IN ('일본');

    UPDATE tally.country
    SET language = 'es'
    WHERE country_name IN ('스페인', '멕시코', '베네수엘라볼리바르', '콜롬비아', '에콰도르', '칠레', '우루과이', '아르헨티나', '페루', '과테말라', '도미니카공화국', '도미니카연방', '볼리비아', '온두라스', '엘살바도르', '니카라과', '파라과이', '파나마', '코스타리카', '기니비사우');

    UPDATE tally.country
    SET language = 'en'
    WHERE country_name IN ('미합중국', '뉴질랜드', '영국', '캐나다', '가나');

    -- 주요 국가들 시차 정보

    UPDATE tally.country
    SET time_difference = 3
    WHERE country_name IN ('뉴질랜드');

    UPDATE tally.country
    SET time_difference = -1
    WHERE country_name IN ('중국', '대만', '마카오', '말레이시아', '싱가포르', '필리핀', '홍콩');

    UPDATE tally.country
    SET time_difference = -2
    WHERE country_name IN ('베트남', '캄보디아', '태국', '인도네시아');

    UPDATE tally.country
    SET time_difference = -3
    WHERE country_name IN ('방글라데시');

    UPDATE tally.country
    SET time_difference = -3.5
    WHERE country_name IN ('인도');

    UPDATE tally.country
    SET time_difference = -4
    WHERE country_name IN ('몰디브');

    UPDATE tally.country
    SET time_difference = -5
    WHERE country_name IN ('그리스');

    UPDATE tally.country
    SET time_difference = -6
    WHERE country_name IN ('러시아', '사우디아라비아', '카타르');

    UPDATE tally.country
    SET time_difference = -7
    WHERE country_name IN ('남아프리카공화국', '네덜란드', '노르웨이', '덴마크', '독일', '룩셈부르크', '스웨덴', '스위스', '스페인', '벨기에', '오스트리아', '이집트', '이탈리아', '핀란드');

    UPDATE tally.country
    SET time_difference = -8
    WHERE country_name IN ('헝가리', '폴란드', '프랑스', '크로아티아', '아일랜드', '영국');

    UPDATE tally.country
    SET time_difference = -9
    WHERE country_name IN ('모로코', '아이슬란드', '포르투갈');

    UPDATE tally.country
    SET time_difference = -12
    WHERE country_name IN ('우루과이', '아르헨티나', '브라질');

    UPDATE tally.country
    SET time_difference = -14
    WHERE country_name IN ('미합중국', '캐나다');

    UPDATE tally.country
    SET time_difference = -15
    WHERE country_name IN ('멕시코', '엘살바도르');

    -- 주요 30개국 날씨 정보 저장

    UPDATE tally.country
    SET capital = 'wellington'
    WHERE country_name IN ('뉴질랜드');

    UPDATE tally.country
    SET capital = 'beijing'
    WHERE country_name IN ('중국');

    UPDATE tally.country
    SET capital = 'tokyo'
    WHERE country_name IN ('일본');

    UPDATE tally.country
    SET capital = 'hanoi'
    WHERE country_name IN ('베트남');

    UPDATE tally.country
    SET capital = 'london'
    WHERE country_name IN ('영국');

    UPDATE tally.country
    SET capital = 'bern'
    WHERE country_name IN ('스위스');

    UPDATE tally.country
    SET capital = 'paris'
    WHERE country_name IN ('프랑스');

    UPDATE tally.country
    SET capital = 'ottawa'
    WHERE country_name IN ('캐나다');

    UPDATE tally.country
    SET capital = 'berlin'
    WHERE country_name IN ('독일');

    UPDATE tally.country
    SET capital = 'roma'
    WHERE country_name IN ('이탈리아');

    UPDATE tally.country
    SET capital = 'macau'
    WHERE country_name IN ('마카오');

    UPDATE tally.country
    SET capital = 'kuala lumpur'
    WHERE country_name IN ('말레이시아');

    UPDATE tally.country
    SET capital = 'singapore'
    WHERE country_name IN ('싱가포르');

    UPDATE tally.country
    SET capital = 'hongkong'
    WHERE country_name IN ('홍콩');

    UPDATE tally.country
    SET capital = 'taipei'
    WHERE country_name IN ('대만');

    UPDATE tally.country
    SET capital = 'manila'
    WHERE country_name IN ('필리핀');

    UPDATE tally.country
    SET capital = 'bangkok'
    WHERE country_name IN ('태국');

    UPDATE tally.country
    SET capital = 'male'
    WHERE country_name IN ('몰디브');

    UPDATE tally.country
    SET capital = 'athens'
    WHERE country_name IN ('그리스');

    UPDATE tally.country
    SET capital = 'moscow'
    WHERE country_name IN ('러시아');

    UPDATE tally.country
    SET capital = 'mexico city'
    WHERE country_name IN ('멕시코');

    UPDATE tally.country
    SET capital = 'budapest'
    WHERE country_name IN ('헝가리');

    UPDATE tally.country
    SET capital = 'warszawa'
    WHERE country_name IN ('폴란드');

    UPDATE tally.country
    SET capital = 'amsterdam'
    WHERE country_name IN ('네덜란드');

    UPDATE tally.country
    SET capital = 'madrid'
    WHERE country_name IN ('스페인');

    UPDATE tally.country
    SET capital = 'brussels'
    WHERE country_name IN ('벨기에');

    UPDATE tally.country
    SET capital = 'wien'
    WHERE country_name IN ('오스트리아');

    UPDATE tally.country
    SET capital = 'copenhagen'
    WHERE country_name IN ('덴마크');

    UPDATE tally.country
    SET capital = 'stockholm'
    WHERE country_name IN ('스웨덴');

    UPDATE tally.country
    SET capital = 'newyork'
    WHERE country_name IN ('미합중국');

    -- 미합중국을 미국으로 변경
    UPDATE tally.country
    SET country_name = '미국'
    WHERE country_name IN ('미합중국');

    -- 영어 없는 거 제거
    delete from country where capital is null;
    ```
